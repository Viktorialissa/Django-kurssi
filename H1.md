##### Alisa Ahokas

# Hello Django

## Aloitetaan teht√§v√§n tekeminen 22.05.2023 üïí 16.39 lukemalla [teht√§v√§nanto](https://terokarvinen.com/2023/python-web-idea-to-production/) sek√§ [materiaalia](https://terokarvinen.com/2022/django-instant-crm-tutorial/?fromSearch=django%204).


1. [Asenna Django-kehitysymp√§rist√∂](#asenna-django-kehitysymp√§rist√∂)
2. [Tee yksinkertainen taulu tietokantaan](#tee-yksinkertainen-taulu-tietokantaan)
3. [Muokkaa tietokantaa Django Admin -weppiliittym√§ll√§](#muokkaa-tietokantaa-django-admin--weppiliittym√§ll√§)
4. [Tee tauluun uusia kentti√§](#tee-tauluun-uusia-kentti√§)
5. [L√§hteet](#l√§hteet)

## Asenna Django-kehitysymp√§rist√∂

Ennen asennuksia aloitetaan komennolla:

    sudo apt-get update

Asennetaan virtuaaliymp√§rist√∂ ja python3-pip paketinhallintamanageri.

    sudo apt-get -y install virtualenv python3-pip

Asennuksen j√§lkeen luokaan hakemisto djangoproject

    mkdir djangoproject

Navigoidaan ko. hakemistoon komennolla:

    cd djangoproject

Hakemiston sis√§ll√§ luodaan env-hakemisto seuraavalla komennolla:

    virtualenv -p python3 --system-site-packages env/

Virtuaaliymp√§rist√∂ aktivoidaan komennolla:

    source env/bin/activate

Virtuaaliymp√§rist√∂st√§ p√§√§see pois k√§ytt√§m√§ll√§ komentoa:

	deactivate

Seuraavaksi voidaan tarkastaa, ett√§ paketit on asennettu virtuaaliymp√§rist√∂√∂n komennolla:

    which pip

KUVA1
<details>

<summary>Terminaali</summary>


![1](https://github.com/Viktorialissa/Django-kurssi/assets/112398757/366719fc-1d99-4f2f-9949-08c763f11262)

</details>

Luodaan microlla requirements tiedosto:

    micro requirements.txt

Microssa ``ctrl+S`` tallentaa ja ``ctrl+Q`` sulkee micron n√§kym√§n.

Kirjoitetaan microon haluttu kirjasto eli django.

Asennetaan requirements-tiedoston sis√§lt√∂ pippi√§ k√§ytt√§en komennolla:

    pip install -r requirements.txt

Tarkistetaan asennettu djangon versio komennolla:

    django-admin --version

Sek√§ sijainti:

    which django-admin

KUVA2

Tehd√§√§n hyv√§n hakemistorakenteen mukaisesti public_sites-hakemisto komennolla:
	
	mkdir public_sites

Navigoidaan sinne komennolla:

	cd public_sites

Luodaan sinne uusi projekti k√§ytt√§en komentoa:

	django-admin startproject alisaco

	cd alisaco
	
	ls
KUVA3

Katsotaan hakemistorakenne graafisemmin k√§ytt√§en treet√§.

	tree public_sites

	kuva treest√§ KUVA4

Py√∂r√§ytet√§√§n projekti k√§yntiin komennolla:
	 
	./manage.py runserver #NOT FOR PROD

Selaimessa aukeaa djangon default-n√§kym√§, kun avataan projektin URL ``http://127.0.0.1:8000/``


## Tee yksinkertainen taulu tietokantaan

P√§ivitet√§√§n tietokanta komennoilla:

	./manage.py makemigrations; ./manage.py migrate

Lis√§t√§√§n admin-k√§ytt√§j√§:

Asennetaan salasanagenraattori komennolla:

	sudo apt-get install pwgen

Generoidaan salasana komennolla:
	
	pwgen -s 20 1 			fZRiOybc8VLxh5dMVUSB

Luodaan superuser k√§ytt√§j√§ komennolla:

	./manage.py createsuperuser

Laitetaan k√§ytt√§j√§lle k√§ytt√§j√§nimi, s√§hk√∂posti sek√§ generoitu salasana.

KUVA7

Menn√§√§n djangon tarjoamalle admin-sivulle lis√§√§m√§ll√§ URL:n per√§√§n /admin eli ``http://127.0.0.1:8000/admin``

Testataan toimivuus komennolla:

	./manage.py runserver #NOT FOR PROD

KUVA8
KUVA9

Avataan terminaaliin toinen v√§lilehti, jossa sovellus py√∂rii samalla, kun jatkokehitet√§√§n sit√§.

Aloitetaan luomalla uusi sovellus komennolla:

	./manage.py startapp bms

T√§m√§ teki uuden bms/ kansion (Book Management System) projektiani varten.

KUVA10

Lis√§t√§√§n sovellus settings.py-tiedoston kohtaan INSTALLED_APPS komennolla:

	    micro alisaco/settings.py

KUVA11

Lis√§t√§√§n sovellukseen luokka tietokantaa varten (ORM). T√§m√§ tapahtuu muokkaamalla models.py-tiedostoa komennolla:

	micro bms/models.py

```python
from django.db import models

class Book(models.Model):
   name = models.CharField(max_length=200)

```

KUVA12

P√§ivitet√§√§n tietokanta komennoilla:

	./manage.py makemigrations; ./manage.py migrate

KUVA13

Muokataan admin-tiedostoa, jotta admin voi sit√§ hallita k√§ytt√§en komentoa:

	micro bms/admin.py

```python
from django.contrib import admin
from . import models

admin.site.register(models.Book)

```
KUVA 14

Nyt uuden taulun pit√§isi n√§ky√§ selaimessa.

KUVA15


## Muokkaa tietokantaa Django Admin -weppiliittym√§ll√§

Nyt selaimessa voi lis√§t√§ kohteita tauluun.

Muokataan n√§kym√§ informatiivisemmaksi k√§ytt√§j√§lle komennolla:


    micro bms/models.py


```python
from django.db import models

class Book(models.Model):
   name = models.CharField(max_length=200)

   def __str__(self):
	return self.name

```

P√§ivitet√§√§n selain ja se n√§ytt√§√§ nyt, jokaisen olion nimen.

## Tee tauluun uusia kentti√§

Tehd√§√§n tauluun uusi kentt√§, jossa on varattu, hyllyss√§ tai lainassa vaihtoehdot. 

```python
from django.db import models

class Book(models.Model):
   StatusIndicator = models.TextChoices('StatusIndicator', 'LAINASSA VARATTU HYLLY')
   name = models.CharField(max_length=200)
   status = models.CharField(blank=True, choices=StatusIndicator.choices, max_length=20)

   def __str__(self):
	return self.name
```

Ja selain n√§ytt√§√§ t√§lt√§

KUVA21

Vika on siin√§, ett√§ unohdin tehd√§ muutokset my√∂s tietokantaan eli komennot:

	./manage.py makemigrations; ./manage.py migrate

KUVA22

Nyt selaimessa n√§kyy muutokset:

KUVA23

Lis√§t√§√§n viel√§ n√§kyville kirjan status, jos se on valittu.

```python
from django.db import models

class Book(models.Model):
   StatusIndicator = models.TextChoices('StatusIndicator', 'LAINASSA VARATTU HYLLY')
   name = models.CharField(max_length=200)
   status = models.CharField(blank=True, choices=StatusIndicator.choices, max_length=20)

   def __str__(self):
	return (f"{self.name}, {self.status}")

```

KUVA24

Selaimessa n√§kym√§ muutoksen j√§lkeen:

KUVA25

> Lopetus üïí 19.45
> Aloitetaan raportin koostaminen üïí 19.46
> Raportin koostaminen loppuu 22.05.2023 üïí 2.09 ja l√§hteet merkit√§√§n.


## L√§hteet:

- [Tero Karvinen - Django 4 Instant Customer Database Tutorial](https://terokarvinen.com/2022/django-instant-crm-tutorial/). Luettu 22.05.2023.
- Tero Karvinen luento 22.05.2023.
- [Tero Karvinen - teht√§v√§](https://terokarvinen.com/2023/python-web-idea-to-production/). Luettu 22.05.2023.
