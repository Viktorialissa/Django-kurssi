##### Alisa Ahokas

# Hello Django

## Aloitetaan tehtÃ¤vÃ¤n tekeminen 22.05.2023 ğŸ•’ 16.39 lukemalla [tehtÃ¤vÃ¤nanto](https://terokarvinen.com/2023/python-web-idea-to-production/) sekÃ¤ [materiaalia](https://terokarvinen.com/2022/django-instant-crm-tutorial/?fromSearch=django%204).


1. [Asenna Django-kehitysympÃ¤ristÃ¶](#asenna-django-kehitysympÃ¤ristÃ¶)
2. [Tee yksinkertainen taulu tietokantaan](#tee-yksinkertainen-taulu-tietokantaan)
3. [Muokkaa tietokantaa Django Admin -weppiliittymÃ¤llÃ¤](#muokkaa-tietokantaa-django-admin--weppiliittymÃ¤llÃ¤)
4. [Tee tauluun uusia kenttiÃ¤](#tee-tauluun-uusia-kenttiÃ¤)
5. Vapaaehtoinen, vaikea: tee kaksi taulua/luokkaa ja niiden vÃ¤lille riippuvuus

## Asenna Django-kehitysympÃ¤ristÃ¶

Ennen asennuksia aloitetaan komennolla:

    sudo apt-get update

Sitten asennetaan virtuaaliympÃ¤ristÃ¶ ja python3-pip paketinhallintamanageri.

    sudo apt-get -y install virtualenv python3-pip

Asennuksen jÃ¤lkeen luokaan hakemisto djangoproject

    mkdir djangoproject

Navigoidaan ko. hakemistoon komennolla:

    cd djangoproject

Hakemiston sisÃ¤llÃ¤ luodaan env-hakemisto seuraavalla komennolla:

    virtualenv -p python3 --system-site-packages env/

VirtuaaliympÃ¤ristÃ¶ aktivoidaan komennolla:

    source env/bin/activate

VirtuaaliympÃ¤ristÃ¶stÃ¤ pÃ¤Ã¤see pois kÃ¤yttÃ¤mÃ¤llÃ¤ komentoa:

	deactivate

Seuraavaksi voidaan tarkastaa, ettÃ¤ paketit on asennettu virtuaaliympÃ¤ristÃ¶Ã¶n komennolla:

    which pip

KUVA1

Luodaan microlla requirements tiedosto:

    micro requirements.txt

Microssa ``ctrl+S`` tallentaa ja ``ctrl+Q`` sulkee micron nÃ¤kymÃ¤n.

Kirjoitetaan microon haluttu kirjasto eli django.

Asennetaan requirements-tiedoston sisÃ¤ltÃ¶ pippiÃ¤ kÃ¤yttÃ¤en komennolla:

    pip install -r requirements.txt

Tarkistetaan asennettu djangon versio komennolla:

    django-admin --version

SekÃ¤ sijainti:

    which django-admin

KUVA2

TehdÃ¤Ã¤n hyvÃ¤n hakemistorakenteen mukaisesti public_sites-hakemisto komennolla:
	
	mkdir public_sites

Navigoidaan sinne komennolla:

	cd public_sites

Luodaan sinne uusi projekti kÃ¤yttÃ¤en komentoa:

	django-admin startproject alisaco

	cd alisaco
	
	ls
KUVA3

Katsotaan hakemistorakenne graafisemmin kÃ¤yttÃ¤en treetÃ¤.

	tree public_sites

	kuva treestÃ¤ KUVA4

PyÃ¶rÃ¤ytetÃ¤Ã¤n projekti kÃ¤yntiin komennolla:
	 
	./manage.py runserver #NOT FOR PROD

Selaimessa aukeaa djangon default-nÃ¤kymÃ¤, kun avataan projektin URL ``http://127.0.0.1:8000/``


## Tee yksinkertainen taulu tietokantaan

PÃ¤ivitetÃ¤Ã¤n tietokanta komennoilla:

	./manage.py makemigrations; ./manage.py migrate

LisÃ¤tÃ¤Ã¤n admin-kÃ¤yttÃ¤jÃ¤:

Asennetaan salasanagenraattori komennolla:

	sudo apt-get install pwgen

Generoidaan salasana komennolla:
	
	pwgen -s 20 1 			fZRiOybc8VLxh5dMVUSB

Luodaan superuser kÃ¤yttÃ¤jÃ¤ komennolla:

	./manage.py createsuperuser

Laitetaan kÃ¤yttÃ¤jÃ¤lle kÃ¤yttÃ¤jÃ¤nimi, sÃ¤hkÃ¶posti sekÃ¤ generoitu salasana.

KUVA7

MennÃ¤Ã¤n djangon tarjoamalle admin-sivulle lisÃ¤Ã¤mÃ¤llÃ¤ URL:n perÃ¤Ã¤n /admin eli ``http://127.0.0.1:8000/admin``

Testataan toimivuus komennolla:

	./manage.py runserver #NOT FOR PROD

KUVA8
KUVA9

Avataan terminaaliin toinen vÃ¤lilehti, jossa sovellus pyÃ¶rii samalla, kun jatkokehitetÃ¤Ã¤n sitÃ¤.

Aloitetaan luomalla uusi sovellus komennolla:

	./manage.py startapp bms

TÃ¤mÃ¤ teki uuden bms/ kansion (Book Management System) projektiani varten.

KUVA10

LisÃ¤tÃ¤Ã¤n sovellus settings.py-tiedoston kohtaan INSTALLED_APPS komennolla:

	    micro alisaco/settings.py

KUVA11

LisÃ¤tÃ¤Ã¤n sovellukseen luokka tietokantaa varten (ORM). TÃ¤mÃ¤ tapahtuu muokkaamalla models.py-tiedostoa komennolla:

	micro bms/models.py

```python
from django.db import models

class Book(models.Model):
   name = models.CharField(max_length=200)

```

KUVA12

PÃ¤ivitetÃ¤Ã¤n tietokanta komennoilla:

	./manage.py makemigrations; ./manage.py migrate

KUVA13

Muokataan admin-tiedostoa, jotta admin voi sitÃ¤ hallita kÃ¤yttÃ¤en komentoa:

	micro bms/admin.py

```python
from django.contrib import admin
from . import models

admin.site.register(models.Book)

```
KUVA 14

Nyt uuden taulun pitÃ¤isi nÃ¤kyÃ¤ selaimessa.

KUVA15


## Muokkaa tietokantaa Django Admin -weppiliittymÃ¤llÃ¤

Nyt selaimessa voi lisÃ¤tÃ¤ kohteita tauluun.

Muokataan nÃ¤kymÃ¤ informatiivisemmaksi kÃ¤yttÃ¤jÃ¤lle komennolla:


    micro bms/models.py


```python
from django.db import models

class Book(models.Model):
   name = models.CharField(max_length=200)

   def __str__(self):
	return self.name

```

PÃ¤ivitetÃ¤Ã¤n selain ja se nÃ¤yttÃ¤Ã¤ nyt, jokaisen olion nimen.

## Tee tauluun uusia kenttiÃ¤

TehdÃ¤Ã¤n tauluun uusi kenttÃ¤, jossa on varattu, hyllyssÃ¤ tai lainassa vaihtoehdot. 

```python
from django.db import models

class Book(models.Model):
   StatusIndicator = models.TextChoices('StatusIndicator', 'LAINASSA VARATTU HYLLY')
   name = models.CharField(max_length=200)
   status = models.CharField(blank=True, choices=StatusIndicator.choices, max_length=20)

   def __str__(self):
	return self.name
```

Ja selain nÃ¤yttÃ¤Ã¤ tÃ¤ltÃ¤

KUVA21

Vika on siinÃ¤, ettÃ¤ unohdin tehdÃ¤ muutokset myÃ¶s tietokantaan eli komennot:

	./manage.py makemigrations; ./manage.py migrate

KUVA22

Nyt selaimessa nÃ¤kyy muutokset:

KUVA23

LisÃ¤tÃ¤Ã¤n vielÃ¤ nÃ¤kyville kirjan status, jos se on valittu.

```python
from django.db import models

class Book(models.Model):
   StatusIndicator = models.TextChoices('StatusIndicator', 'LAINASSA VARATTU HYLLY')
   name = models.CharField(max_length=200)
   status = models.CharField(blank=True, choices=StatusIndicator.choices, max_length=20)

   def __str__(self):
	return (f"{self.name}, {self.status}")

```

KUVA24

Selaimessa nÃ¤kymÃ¤ muutoksen jÃ¤lkeen:

KUVA25

> Lopetus ğŸ•’ 19.45
> Aloitetaan raportin koostaminen ğŸ•’ 19.46
> Raportin koostaminen loppuu 22.05.2023 ğŸ•’ 2.09 ja lÃ¤hteet merkitÃ¤Ã¤n.


## LÃ¤hteet:

- [Tero Karvinen - Django 4 Instant Customer Database Tutorial](https://terokarvinen.com/2022/django-instant-crm-tutorial/). Luettu 22.05.2023.
- Tero Karvinen luento 22.05.2023.
- [Tero Karvinen - tehtÃ¤vÃ¤](https://terokarvinen.com/2023/python-web-idea-to-production/). Luettu 22.05.2023.
